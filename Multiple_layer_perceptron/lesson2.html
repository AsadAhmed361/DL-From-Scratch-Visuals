<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLP with Activation Functions</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Orbitron:wght@400;700&display=swap');

        :root {
            --bg-color: #0d1a26;
            --surface-color: #1a2a3a;
            --primary-color: #00aaff;
            --accent-color: #ff6b6b;
            --text-color: #e0e0e0;
            --secondary-text-color: #a0a0a0;
            --shadow-color: rgba(0, 0, 0, 0.6);
            --border-radius: 8px;
            --gradient-start: #1a2a3a;
            --gradient-end: #2a3d50;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--bg-color), #09121a);
            color: var(--text-color);
            margin: 0;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            flex-wrap: wrap;
            line-height: 1.5;
            background-attachment: fixed;
            font-size: 14px;
        }

        .container {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 1000px;
            gap: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin: 10px 0;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(0, 170, 255, 0.7);
            letter-spacing: 1px;
            font-size: 24px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        @media (max-width: 992px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .nn-visualization-panel, .controls-panel {
            background: linear-gradient(145deg, var(--gradient-start), var(--gradient-end));
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px var(--shadow-color);
            padding: 20px;
            border: 1px solid rgba(0, 170, 255, 0.2);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .nn-visualization-panel h2, .controls-panel h2, .explanation-panel h2 {
            margin: 0;
            color: var(--primary-color);
            border-bottom: 1px solid var(--primary-color);
            padding-bottom: 8px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 400;
            text-shadow: 0 0 5px rgba(0, 170, 255, 0.5);
            font-size: 18px;
        }
        
        .nn-graph {
            width: 100%;
            height: 300px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: relative;
        }

        .layer {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 25px;
            position: relative;
        }

        .layer-label {
            position: absolute;
            top: -20px;
            color: var(--primary-color);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 14px;
            text-shadow: 0 0 5px rgba(0, 170, 255, 0.7);
            white-space: nowrap;
        }
        
        .hidden-layer {
            justify-content: space-between;
        }

        .neuron {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid var(--primary-color);
            background-color: rgba(0, 170, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            transition: background-color 0.4s ease, transform 0.2s ease, box-shadow 0.4s ease;
            position: relative;
            box-shadow: 0 0 10px rgba(0, 170, 255, 0.7);
            font-size: 14px;
            color: var(--text-color);
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
            cursor: pointer;
        }
        
        .neuron:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0, 170, 255, 0.9), 0 0 30px rgba(0, 170, 255, 0.4);
            z-index: 10;
        }

        .neuron-label {
            top: -20px;
            font-size: 11px;
        }

        .connections-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            display: none;
        }
        
        .connections-container.active {
            display: block;
        }

        .connection {
            stroke-width: 1.5px;
            opacity: 0.5;
            transition: stroke-width 0.3s ease, opacity 0.3s ease, stroke 0.3s ease;
            pointer-events: all;
            cursor: pointer;
        }
        
        .connection.positive {
            stroke: var(--primary-color);
            opacity: 0.7;
            stroke-width: 2.5px;
        }

        .connection.negative {
            stroke: var(--accent-color);
            opacity: 0.7;
            stroke-width: 2.5px;
        }
        
        .connection:hover {
            stroke-width: 4px;
            opacity: 1;
        }
        
        .weight-label {
            font-size: 10px;
            padding: 2px 4px;
            background-color: var(--surface-color);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            pointer-events: none;
            z-index: 10;
            transition: opacity 0.2s ease;
            display: none;
        }
        
        .weight-label.active {
            display: block;
        }

        .output-label {
            font-size: 20px;
            margin-top: 10px;
        }
        
        .controls-panel {
            gap: 15px;
        }
        
        summary {
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            color: var(--primary-color);
            padding: 8px 0;
            border-bottom: 1px solid var(--secondary-text-color);
        }

        details[open] summary {
            border-bottom: none;
        }
        
        .slider-group {
            margin-bottom: 10px;
        }
        
        label {
            margin-bottom: 5px;
            font-size: 13px;
        }

        .slider-container {
            gap: 10px;
        }
        
        input[type="range"] {
            height: 8px;
        }

        input[type="range"]::-webkit-slider-thumb {
            width: 20px;
            height: 20px;
        }

        .slider-value {
            min-width: 40px;
            font-size: 1em;
            padding: 4px 8px;
        }
        
        .explanation-panel {
            grid-column: span 2;
            padding: 20px;
            background: linear-gradient(145deg, var(--gradient-start), var(--gradient-end));
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px var(--shadow-color);
            border: 1px solid rgba(0, 170, 255, 0.2);
        }

        .explanation-panel p {
            font-size: 13px;
            margin-bottom: 8px;
        }
        
        .explanation-panel h3 {
            font-size: 16px;
            margin-top: 15px;
            margin-bottom: 8px;
        }

        .explanation-panel ul {
            font-size: 13px;
            list-style-type: none;
            padding-left: 0;
        }

        .explanation-panel ul li {
            position: relative;
            padding-left: 20px;
            margin-bottom: 5px;
        }
        
        .explanation-panel ul li::before {
            content: 'â€¢';
            color: var(--primary-color);
            position: absolute;
            left: 0;
            font-size: 1.2em;
            line-height: 1;
        }

        code {
            font-size: 0.8em;
            padding: 1px 4px;
            background-color: #2a3d50;
            color: var(--primary-color);
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .control-buttons button, select {
            padding: 10px 15px;
            font-size: 1em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            background-color: var(--surface-color);
            color: var(--text-color);
        }
        
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23e0e0e0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            padding-right: 30px;
        }

        .reset-btn {
            background-color: var(--accent-color);
            color: var(--text-color);
        }
        .show-lines-btn {
            background-color: var(--primary-color);
            color: var(--surface-color);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>MLP with Activation Functions: Study vs. Sleep ðŸ§ </h1>
    <div class="main-grid">
        <div class="nn-visualization-panel">
            <h2>Multi-Layer Perceptron (MLP)</h2>
            <div class="nn-graph">
                <div class="layer input-layer">
                    <span class="layer-label">Input Layer</span>
                    <div class="neuron" id="input-study" data-tooltip="Represents the number of study hours."><span class="neuron-label">Study Hrs (x1)</span></div>
                    <div class="neuron" id="input-sleep" data-tooltip="Represents the number of sleep hours."><span class="neuron-label">Sleep Hrs (x2)</span></div>
                </div>
                <div class="layer hidden-layer">
                    <span class="layer-label">Hidden Layer</span>
                    <div class="neuron" id="hidden-h1" data-tooltip="Transforms raw inputs into an abstract feature."><span class="neuron-label">Hidden Neuron 1</span></div>
                    <div class="neuron" id="hidden-h2" data-tooltip="Transforms raw inputs into another abstract feature."><span class="neuron-label">Hidden Neuron 2</span></div>
                </div>
                <div class="layer output-layer">
                    <span class="layer-label">Output Layer</span>
                    <div class="neuron" id="output-pass" data-tooltip="Calculates the final probability of passing the exam."><span class="neuron-label">Pass Probability</span></div>
                </div>
                <svg class="connections-container"></svg>
            </div>
            <div class="output-label" id="output-label">Pass Probability: 0.00%</div>
        </div>

        <div class="controls-panel">
            <h2>Network Controls</h2>
            <div class="slider-group">
                <label for="study-hours-slider">Study Hours (x1):</label>
                <div class="slider-container">
                    <input type="range" id="study-hours-slider" min="0" max="10" step="0.1" value="5">
                    <span class="slider-value" id="study-hours-value">5.0</span>
                </div>
            </div>
            <div class="slider-group">
                <label for="sleep-hours-slider">Sleep Hours (x2):</label>
                <div class="slider-container">
                    <input type="range" id="sleep-hours-slider" min="0" max="10" step="0.1" value="7">
                    <span class="slider-value" id="sleep-hours-value">7.0</span>
                </div>
            </div>

            <div class="slider-group">
                <label for="activation-select">Hidden Layer Activation:</label>
                <select id="activation-select">
                    <option value="sigmoid" selected>Sigmoid</option>
                    <option value="relu">ReLU</option>
                    <option value="tanh">Tanh</option>
                </select>
            </div>
            
            <details>
                <summary>Hidden Layer Weights & Biases</summary>
                <div class="slider-group">
                    <label for="w11-slider">w1,1 (x1 to h1):</label>
                    <div class="slider-container">
                        <input type="range" id="w11-slider" min="-5" max="5" step="0.1" value="1.0">
                        <span class="slider-value" id="w11-value">1.0</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="w21-slider">w2,1 (x2 to h1):</label>
                    <div class="slider-container">
                        <input type="range" id="w21-slider" min="-5" max="5" step="0.1" value="-0.5">
                        <span class="slider-value" id="w21-value">-0.5</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="b1-slider">Bias b1 (h1):</label>
                    <div class="slider-container">
                        <input type="range" id="b1-slider" min="-5" max="5" step="0.1" value="0.5">
                        <span class="slider-value" id="b1-value">0.5</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="w12-slider">w1,2 (x1 to h2):</label>
                    <div class="slider-container">
                        <input type="range" id="w12-slider" min="-5" max="5" step="0.1" value="-1.0">
                        <span class="slider-value" id="w12-value">-1.0</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="w22-slider">w2,2 (x2 to h2):</label>
                    <div class="slider-container">
                        <input type="range" id="w22-slider" min="-5" max="5" step="0.1" value="1.5">
                        <span class="slider-value" id="w22-value">1.5</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="b2-slider">Bias b2 (h2):</label>
                    <div class="slider-container">
                        <input type="range" id="b2-slider" min="-5" max="5" step="0.1" value="-0.2">
                        <span class="slider-value" id="b2-value">-0.2</span>
                    </div>
                </div>
            </details>
            
            <details>
                <summary>Output Layer Weights & Biases</summary>
                <div class="slider-group">
                    <label for="wo1-slider">w_o1 (h1 to o1):</label>
                    <div class="slider-container">
                        <input type="range" id="wo1-slider" min="-5" max="5" step="0.1" value="2.0">
                        <span class="slider-value" id="wo1-value">2.0</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="wo2-slider">w_o2 (h2 to o1):</label>
                    <div class="slider-container">
                        <input type="range" id="wo2-slider" min="-5" max="5" step="0.1" value="1.0">
                        <span class="slider-value" id="wo2-value">1.0</span>
                    </div>
                </div>
                <div class="slider-group">
                    <label for="bo-slider">Bias b_o (o1):</label>
                    <div class="slider-container">
                        <input type="range" id="bo-slider" min="-5" max="5" step="0.1" value="0.0">
                        <span class="slider-value" id="bo-value">0.0</span>
                    </div>
                </div>
            </details>
            
            <div class="control-buttons">
                <button class="show-lines-btn" id="show-lines-btn">Show Connections</button>
                <button class="reset-btn" id="reset-btn">Reset All Values</button>
            </div>
        </div>
    </div>
    
    <div class="explanation-panel">
        <h2>Detailed Explanation: How this MLP Works</h2>
        <p>A **Multi-Layer Perceptron (MLP)** is a type of neural network with at least one **hidden layer** between the input and output layers. Unlike a simple single neuron, an MLP can learn and model complex, non-linear relationships in data. This visualization breaks down how that happens, layer by layer.</p>

        <h3>1. The Input Layer: Raw Data</h3>
        <ul>
            <li><strong>Input Neurons (`x1`, `x2`):</strong> These simply hold our raw input values: Study Hours and Sleep Hours. They pass these values to the next layer.</li>
        </ul>

        <h3>2. The Hidden Layer: The "Black Box"</h3>
        <p>This is where the network creates more meaningful, internal representations of the inputs. Our hidden layer has two neurons, `h1` and `h2`.</p>
        <p>Each hidden neuron receives a weighted sum of the inputs from the previous layer. Think of it as a single neuron calculation happening multiple times in parallel.</p>
        <ul>
            <li><strong>Hidden Neuron 1 (h1) Calculation:</strong>
                <p><code>h1_input = (x1 * w1,1) + (x2 * w2,1) + b1</code></p>
                <p>The output of <code>h1</code> is then passed through a **Sigmoid** activation function to get its final value.</p>
            </li>
            <li><strong>Hidden Neuron 2 (h2) Calculation:</strong>
                <p><code>h2_input = (x1 * w1,2) + (x2 * w2,2) + b2</code></p>
                <p>Its output is also passed through the Sigmoid activation function.</p>
            </li>
        </ul>
        <p><strong>Why is this important?</strong> The outputs of the hidden neurons (`h1_output` and `h2_output`) are new, transformed features. The network creates these concepts on its own to better understand the inputs.</p>

        <h3>3. The Output Layer: The Final Prediction</h3>
        <p>The final output neuron takes the outputs of the hidden layer as its new inputs. It performs a final weighted sum to produce the prediction.</p>
        <ul>
            <li><strong>Output Neuron (o1) Calculation:</strong>
                <p><code>o1_input = (h1_output * w_o1) + (h2_output * w_o2) + b_o</code></p>
                <p>The output is then passed through the Sigmoid activation function to give us our final probability.</p>
            </li>
        </ul>
        <p><strong>Putting it all together:</strong> This network first learns how to combine the raw "study" and "sleep" inputs into more meaningful signals in the hidden layer, and then uses those signals to make the final "pass" prediction. This multi-step process allows it to solve problems that a single neuron simply can't handle.</p>

        ---

        <h3>Activation Functions Explained</h3>
        <p>An activation function introduces non-linearity, allowing the network to learn more complex patterns than simple linear models. Here are the three options:</p>
        <ul>
            <li>**Sigmoid:** Compresses the input value into a range between **0 and 1**. This makes it perfect for output neurons that predict a probability, like our "pass probability" here. However, it can suffer from "vanishing gradients" in deep networks.</li>
            <li>**ReLU (Rectified Linear Unit):** The simplest and most popular choice. It outputs the input directly if it's positive, and outputs **0** if the input is negative. It is computationally efficient but can "die" for negative inputs.</li>
            <li>**Tanh (Hyperbolic Tangent):** Similar to Sigmoid, but it maps inputs to a range between **-1 and 1**. This is often preferred over Sigmoid for hidden layers because its output is centered around zero, which can help with training.</li>
        </ul>
    </div>
</div>

<script>
    const state = {
        inputs: { study: 5, sleep: 7 },
        hidden: { h1: 0, h2: 0 },
        output: { o1: 0 },
        weights: {
            w11: 1.0, w21: -0.5,
            w12: -1.0, w22: 1.5,
            wo1: 2.0, wo2: 1.0
        },
        biases: { b1: 0.5, b2: -0.2, bo: 0.0 },
        activation: 'sigmoid',
    };

    const defaultState = JSON.parse(JSON.stringify(state));

    const elements = {
        sliders: {
            study: document.getElementById('study-hours-slider'),
            sleep: document.getElementById('sleep-hours-slider'),
            w11: document.getElementById('w11-slider'),
            w21: document.getElementById('w21-slider'),
            b1: document.getElementById('b1-slider'),
            w12: document.getElementById('w12-slider'),
            w22: document.getElementById('w22-slider'),
            b2: document.getElementById('b2-slider'),
            wo1: document.getElementById('wo1-slider'),
            wo2: document.getElementById('wo2-slider'),
            bo: document.getElementById('bo-slider'),
        },
        values: {
            study: document.getElementById('study-hours-value'),
            sleep: document.getElementById('sleep-hours-value'),
            w11: document.getElementById('w11-value'),
            w21: document.getElementById('w21-value'),
            b1: document.getElementById('b1-value'),
            w12: document.getElementById('w12-value'),
            w22: document.getElementById('w22-value'),
            b2: document.getElementById('b2-value'),
            wo1: document.getElementById('wo1-value'),
            wo2: document.getElementById('wo2-value'),
            bo: document.getElementById('bo-value'),
        },
        neurons: {
            inputStudy: document.getElementById('input-study'),
            inputSleep: document.getElementById('input-sleep'),
            hiddenH1: document.getElementById('hidden-h1'),
            hiddenH2: document.getElementById('hidden-h2'),
            outputPass: document.getElementById('output-pass')
        },
        outputLabel: document.getElementById('output-label'),
        connectionsSVG: document.querySelector('.connections-container'),
        resetBtn: document.getElementById('reset-btn'),
        showLinesBtn: document.getElementById('show-lines-btn'),
        activationSelect: document.getElementById('activation-select')
    };

    let connectionsVisible = false;

    const activationFunctions = {
        sigmoid: x => 1 / (1 + Math.exp(-x)),
        relu: x => Math.max(0, x),
        tanh: x => Math.tanh(x)
    };

    function calculateForwardPropagation() {
        const { inputs, weights, biases, activation } = state;
        const { study, sleep } = inputs;
        const { w11, w21, w12, w22, wo1, wo2 } = weights;
        const { b1, b2, bo } = biases;

        const studyNormalized = study / 10;
        const sleepNormalized = sleep / 10;
        elements.neurons.inputStudy.innerText = study.toFixed(1);
        elements.neurons.inputSleep.innerText = sleep.toFixed(1);

        const hiddenActivationFunc = activationFunctions[activation];
        const outputActivationFunc = activationFunctions.sigmoid;

        // -- HIDDEN LAYER CALCULATION --
        const z1 = (studyNormalized * w11) + (sleepNormalized * w21) + b1;
        const h1_output = hiddenActivationFunc(z1);
        state.hidden.h1 = h1_output;

        const z2 = (studyNormalized * w12) + (sleepNormalized * w22) + b2;
        const h2_output = hiddenActivationFunc(z2);
        state.hidden.h2 = h2_output;
        
        elements.neurons.hiddenH1.innerText = h1_output.toFixed(2);
        elements.neurons.hiddenH2.innerText = h2_output.toFixed(2);
        elements.neurons.hiddenH1.style.backgroundColor = `hsl(210, 70%, ${20 + (h1_output / 1.5) * 50}%)`;
        elements.neurons.hiddenH2.style.backgroundColor = `hsl(210, 70%, ${20 + (h2_output / 1.5) * 50}%)`;

        // -- OUTPUT LAYER CALCULATION --
        const zo = (h1_output * wo1) + (h2_output * wo2) + bo;
        const outputProbability = outputActivationFunc(zo);
        state.output.o1 = outputProbability;

        elements.neurons.outputPass.innerText = outputProbability.toFixed(2);
        elements.neurons.outputPass.style.backgroundColor = `hsl(${120 * outputProbability}, 70%, ${20 + outputProbability * 50}%)`;
        elements.outputLabel.innerText = `Pass Probability: ${(outputProbability * 100).toFixed(2)}%`;

        if (connectionsVisible) {
            drawConnections();
        } else {
            elements.connectionsSVG.innerHTML = '';
            document.querySelectorAll('.weight-label').forEach(label => label.remove());
        }
    }

    function drawConnections() {
        elements.connectionsSVG.innerHTML = '';
        document.querySelectorAll('.weight-label').forEach(label => label.remove());

        const svg = elements.connectionsSVG;
        const neuronMap = {
            inputStudy: elements.neurons.inputStudy,
            inputSleep: elements.neurons.inputSleep,
            hiddenH1: elements.neurons.hiddenH1,
            hiddenH2: elements.neurons.hiddenH2,
            outputPass: elements.neurons.outputPass
        };

        const connections = [
            { from: 'inputStudy', to: 'hiddenH1', weight: state.weights.w11 },
            { from: 'inputSleep', to: 'hiddenH1', weight: state.weights.w21 },
            { from: 'inputStudy', to: 'hiddenH2', weight: state.weights.w12 },
            { from: 'inputSleep', to: 'hiddenH2', weight: state.weights.w22 },
            { from: 'hiddenH1', to: 'outputPass', weight: state.weights.wo1 },
            { from: 'hiddenH2', to: 'outputPass', weight: state.weights.wo2 },
        ];

        connections.forEach(conn => {
            const startNeuron = neuronMap[conn.from];
            const endNeuron = neuronMap[conn.to];
            const startRect = startNeuron.getBoundingClientRect();
            const endRect = endNeuron.getBoundingClientRect();
            const svgRect = svg.getBoundingClientRect();

            const startX = startRect.right - svgRect.left - 5;
            const startY = startRect.top + startRect.height / 2 - svgRect.top;
            const endX = endRect.left - svgRect.left + 5;
            const endY = endRect.top + endRect.height / 2 - svgRect.top;

            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', startX);
            line.setAttribute('y1', startY);
            line.setAttribute('x2', endX);
            line.setAttribute('y2', endY);
            line.classList.add('connection');
            if (conn.weight > 0) {
                line.classList.add('positive');
            } else if (conn.weight < 0) {
                line.classList.add('negative');
            }
            line.style.opacity = Math.min(1, Math.abs(conn.weight) / 5 + 0.3);
            line.style.strokeWidth = `${Math.min(5, Math.abs(conn.weight) / 1.5 + 1)}px`;
            svg.appendChild(line);

            const midX = (startX + endX) / 2;
            const midY = (startY + endY) / 2;
            const weightLabel = document.createElement('div');
            weightLabel.classList.add('weight-label', 'active');
            weightLabel.innerText = conn.weight.toFixed(2);
            weightLabel.style.left = `${midX}px`;
            weightLabel.style.top = `${midY - 15}px`;
            elements.connectionsSVG.parentElement.appendChild(weightLabel);
        });
    }

    function updateStateFromSliders() {
        state.inputs.study = parseFloat(elements.sliders.study.value);
        state.inputs.sleep = parseFloat(elements.sliders.sleep.value);
        state.weights.w11 = parseFloat(elements.sliders.w11.value);
        state.weights.w21 = parseFloat(elements.sliders.w21.value);
        state.biases.b1 = parseFloat(elements.sliders.b1.value);
        state.weights.w12 = parseFloat(elements.sliders.w12.value);
        state.weights.w22 = parseFloat(elements.sliders.w22.value);
        state.biases.b2 = parseFloat(elements.sliders.b2.value);
        state.weights.wo1 = parseFloat(elements.sliders.wo1.value);
        state.weights.wo2 = parseFloat(elements.sliders.wo2.value);
        state.biases.bo = parseFloat(elements.sliders.bo.value);

        updateSliderValues();
        calculateForwardPropagation();
    }

    function updateSliderValues() {
        for (const key in elements.values) {
            elements.values[key].innerText = parseFloat(elements.sliders[key].value).toFixed(1);
        }
    }

    function resetNetwork() {
        Object.assign(state, JSON.parse(JSON.stringify(defaultState)));
        for (const key in elements.sliders) {
            const slider = elements.sliders[key];
            const defaultValue = defaultState.inputs[key] !== undefined ? defaultState.inputs[key] : (defaultState.weights[key] !== undefined ? defaultState.weights[key] : defaultState.biases[key]);
            slider.value = defaultValue;
        }
        elements.activationSelect.value = defaultState.activation;
        updateStateFromSliders();
    }
    
    function toggleConnections() {
        connectionsVisible = !connectionsVisible;
        elements.showLinesBtn.innerText = connectionsVisible ? "Hide Connections" : "Show Connections";
        elements.connectionsSVG.classList.toggle('active', connectionsVisible);
        document.querySelectorAll('.weight-label').forEach(label => label.classList.toggle('active', connectionsVisible));
        calculateForwardPropagation();
    }

    elements.activationSelect.addEventListener('change', (event) => {
        state.activation = event.target.value;
        calculateForwardPropagation();
    });

    for (const key in elements.sliders) {
        elements.sliders[key].addEventListener('input', updateStateFromSliders);
    }
    elements.resetBtn.addEventListener('click', resetNetwork);
    elements.showLinesBtn.addEventListener('click', toggleConnections);

    updateStateFromSliders();
    window.addEventListener('resize', calculateForwardPropagation);
</script>

</body>
</html>
